<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head th:replace="layout :: head"> </head>
  <body>
    <head th:replace="layout :: header"> </head>

    <div class="container">
      <div class="row justify-content-center">
        <form
          th:action="@{/pedidos/cliente}"
          th:object="${cliente}"
          method="POST"
          class="col-8"
        >
          <div class="form-group">
            <label for="inputCliente">Cliente</label>
            <select id="inputCliente" class="form-control" th:name="idCliente">
              <option
                th:each="cliente : ${clientes}"
                th:value="${cliente.getId_cliente}"
                th:text="${cliente.getNombre} + ' ' + ${cliente.getApellido}"
              ></option>
            </select>
          </div>
          <div class="d-flex justify-content-center mt-3">
            <button type="submit" class="btn btn-primary">Buscar</button>
          </div>
        </form>
      </div>

      <div class="row justify-content-center">
        <form
          th:action="@{/pedidos/fecha_entrega}"
          th:object="${cliente}"
          method="POST"
          class="col-8"
        >
          <div class="form-group">
            <label for="inputFechaEntrega">Fecha de entrega</label>
            <input
              type="date"
              name="fechaEntrega"
              id="inputFechaEntrega"
              class="form-control"
              placeholder="Ingresar fecha de entrega"
            />
          </div>
          <div class="d-flex justify-content-center mt-3">
            <button type="submit" class="btn btn-primary">Buscar</button>
          </div>
        </form>
      </div>
    </div>

    <div class="container">
      <h2>Pedidos</h2>
      <table class="table table-striped table-sm">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Fecha</th>
            <th scope="col">Cliente</th>
            <th scope="col">Importe</th>
            <th scope="col">Fecha Entrega</th>
            <th scope="col">Detalle</th>
            <th scope="col">Estado</th>
            <th scope="col">Actualizar Estado</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="pedido : ${pedidos}">
            <th
              scope="row"
              class="align-middle"
              th:text="${pedido.getNro_pedido}"
            ></th>
            <td class="align-middle" th:text="${pedido.getFecha}"></td>
            <td
              class="align-middle"
              th:text="${pedido.getCliente.getNombre} + ' ' + ${pedido.getCliente.getApellido}"
            ></td>
            <td
              class="align-middle"
              th:text="${pedido.getDetalle.getImporte}"
            ></td>
            <td class="align-middle" th:text="${pedido.getFecha_entrega}"></td>
            <td class="align-middle">
              <a
                class="btn btn-primary"
                th:href="@{/pedidos/ver_detalle(idPedido=${pedido.getNro_pedido})}"
                role="button"
                >Ver Detalle</a
              >
            </td>
            <td
              class="align-middle"
              th:text="${pedido.getEstado().getDescripcion}"
              th:if="${pedido.getEstado() != null}"
            ></td>
            <td class="align-middle" th:unless="${pedido.getEstado() != null}">
              -
            </td>
            <td>
              <form
                class="form-inline"
                th:action="@{/pedidos/update_estado}"
                method="POST"
              >
                <div class="input-group">
                  <input
                    type="hidden"
                    th:name="idPedido"
                    th:value="${pedido.getNro_pedido}"
                  />
                  <label for="inputUpdateEstado"></label>
                  <select
                    id="inputUpdateEstado"
                    class="form-control"
                    th:name="idNuevoEstado"
                  >
                    <option
                      th:each="estado : ${estados}"
                      th:value="${estado.getId_estado}"
                      th:text="${estado.getDescripcion}"
                    ></option>
                  </select>
                  <div class="input-group-append">
                    <button type="submit" class="btn btn-primary btn-sm">
                      Actualizar
                    </button>
                  </div>
                </div>
              </form>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <head th:replace="layout :: scripts"> </head>
  </body>
</html>
